\documentclass[dissertation.tex]{subfiles}
\begin{document}
\chapter{Prerequisites}
\section{Voronoi diagrams}\label{sec:voronoi}
\section{Splines and B-splines}\label{sec:spline}
A \emph{spline} is a piecewise polynomial function with prescribed
regularity on its domain.

More formally we define a spline
$$S:[a,b]\subset\mR\rightarrow\mR$$
as follows.
We have a partition of that interval defined by the \emph{breakpoints}
$$\tau = \{\tau_0,\dots,\tau_l\}$$
such that $a=\tau_0<\tau_1<\dots<\tau_{l-1}<\tau_l=b$ forming $l$
intervals
$$
I_i=
\begin{cases}
  [\tau_i,\tau_{i+1}) & \mbox{if } i=0,\dots,l-2\\
    [\tau_i,\tau_{i+1}] & \mbox{if } i=l-1\\
\end{cases}
$$
is possible to define the following spaces:
\paragraph{Piecewise polynomial functions space} $P_{m,\tau}$
is the space of the functions that are polynomials of maximum degree $m$
in each interval $I_i$ of the partition, formally:
\begin{multline*}
  P_{m,\tau}=\{f:[a,b]\rightarrow\mR\ \mid\ \exists p_0\dots
  p_{l-1}\in\Pi_m \ \text{such that}\\
  f(t)=p(t),\ \forall t\in I_i,\
  i=0\dots l-1\}
\end{multline*}
where $\Pi_m$ is the space of the polynomials of degree $\le m$. The
dimension of $P_{m,\tau}$ is $l(m+1)$ because the dimension of $\Pi_m$
is $m+1$.
\paragraph{Classic spline space} $S_{m,\tau}$ is the space of
the piecewise polynomial functions that have continuity $C^{m-1}$ in
the junctions of the intervals, formally:
$$
S_{m,\tau}=P_{m,\tau}\cap C^{m-1}[a,b].
$$
The dimension of this space is $l(m+1)-(l-1)\cdot m\,=\,l+m$.
\paragraph{Generalized spline space} $S_{m,\tau,M}$ is the
space of piecewise polynomial function of degree $m$ with a prescribed
regularity at each breakpoint ranging from $-1$ to $m-1$. The
regularity is prescribed by the multiplicity vector
$$
M=\{m_1,\dots,m_{l-1}\},\quad m_i\in\mN,\quad 1\leq m_i\leq m+1
$$
as follows,
\begin{multline*}
  S_{m,\tau,M}=\{f:[a,b]\rightarrow\mR\ \mid\ \exists p_0\dots
  p_{l-1}\in\Pi_m \ \text{such that}\\
  f(t)=p(t),\ \forall t\in I_i,\
  i=0\dots l-1\ \text{and}\\
  p_{i-1}^{(j)}(\tau_i)=p_{i}^{(j)}(\tau_i),\ j=0,\dots,m-m_i,\ i=1,\dots,l-1\}.
\end{multline*}
The dimension of the space is equal to 
$$
l(m+1)-\sum_{i=1}^{l-1}(m-m_i+1)=m+\mu +1\qquad(\mu=\sum_{i=1}^{l-1}m_i)
$$

and is true that
$$
\Pi_m\subseteq S_{m,\tau}\subseteq S_{m,\tau,M}\subseteq P_{m,\tau},
$$
in particular:
\begin{itemize}
  \item if $m_i=1$ for all $i=1,\dots,l-1$, then
    $S_{m,\tau,M}=S_{m,\tau}$;
  \item if $m_i=m+1$ for all $i=1,\dots,l-1$, then
    $S_{m,\tau,M}=P_{m,\tau}$.
\end{itemize}

\subsection{Truncated-powers base for classic splines}\label{sec:truncpow}
A truncated power $(t-\tau_i)_+^m$ is
defined by
$$
(t-\tau_i)_+^m=
\begin{cases}
  0,&\mbox{if}\quad t\leq\tau_i\\
  (t-\tau_i)^m, &\mbox{otherwise}.
\end{cases}
$$
Is possible to demonstrate that the functions
$$
g_i(t)=(t-\tau_i)_+^m)\ \in S_{m\tau},\quad i=1,\dots,l-1
$$
are linearly independents, and that
$$
1,t,t^2,\dots,t^m,(t-\tau_1)_+^m,\dots,(t-\tau_{l-1})_+^m
$$
form a base for the classic spline functions space. A generic element
from this space can be expressed like
\begin{equation}\label{eq:classicSplineElement}
  S(t)=\sum_{i=0}^m c_i t^i\, +\, \sum_{j=1}^{l-1} d_i (t-\tau_j)_+^m.
\end{equation}

\subsection{B-splines base for classic splines}\label{sec:bsplines}
\emph{B-splines} are a specific base wich can be alternatively used to
represent any generalized spline. In this
paragraph we consider only the classic splines $S_{m,\tau}$ and not
the generalized splines $S_{m,\tau,M}$, furthermore we consider the
\emph{order}: $k=m+1$.

For defining the B-splines we need to extend the partition vector
$\tau=\{\tau_0,\cdots,\tau_l\}$ with $m$ nodes to the left and $m$ to
the right, so we define a new vector
$$
T=\{t_0,\dots,t_{m-1},t_{m},\dots,t_{n+1},t_{n+2},\dots,t_{n+m+1}\}
$$
such that
$$
t_0\leq\dots\leq t_{m-1}\leq \{t_{m}\equiv\tau_0\equiv a\}<\dots<
\{t_{n+1}\equiv\tau_l\equiv b\}\leq t_{n+2}\leq\dots\leq t_{n+m+1}.
$$
$\tau$ have $l+1$ elements, so we can calculate the value of
$$
n=l+m-1,
$$
and the dimension of $S_{m,\tau}$ is
$$
l+m=n+1
$$
that is the number of necessary bases for the space.

The $n+1$ basis $N_{i,m+1}(t)$ of the B-splines of degree $m$ for
$i=0,\dots,n$ are defined by the 
recursive formula:
\begin{align*}
  N_{i,1}(t) &=
  \begin{cases}
    1,\quad \mbox{if}\quad t_i\leq t<t_{i+1}\\
    0,\quad \mbox{otherwise}
  \end{cases}\\
  N_{i,r}(t) &= \omega_{i,r-1}(t)\cdot N_{i,r-1}(t)\ +\
  (1-\omega_{i+1,r-1}(t))\cdot N_{i+1,r-1}(t)\\
             &\pushright r=2,\dots,m+1
\end{align*}
where
$$
\omega_{i,r}(t) = \begin{cases}
  \frac{t-t_i}{t_{i+r}-t_i},&\mbox{if }t_i\neq t_{i+r}\\
  0, &\mbox{otherwise.}
\end{cases}
$$

The elements of the classic splines space can be expressed in the form
\begin{equation}\label{eq:bsplineElement}
  S(t)=\sum_{i=0}^nv_i N_{i,k}(t).
\end{equation}

\subsection{Spline curves}
A parametric spline \emph{curve} $\mathbf{S}(t)$ is a curve in a certain
dimension $dim$ obtained applying a spline function to a set of points
in the same dimension $dim$
called \emph{control vertices}. We can apply the control vertices to a
spline expressed with the truncated powers as in
\cref{eq:classicSplineElement} replacing the coefficients $c_i$ and
$d_i$ with points
\begin{equation}\label{eq:classicSplineCurve}
  \mathbf{S}(t)=\sum_{i=0}^m \mathbf{c_i}\cdot t^i\, +\, \sum_{j=1}^{l-1} \mathbf{d_i}\cdot (t-\tau_j)_+^m  
\end{equation}

this form obtained with the truncated-powers base is not a practical
representation of a curve because
there isn't an intuitive correlation between the points
$\mathbf{c_i}$, $\mathbf{d_j}$ and the curve itself. Moreover
calculating $\mathbf{S}(t)$ is not a well conditioned problem.
 For resolving those problems we
defined the \emph{B-splines base} in \cref{sec:bsplines}.

We can apply control vertices to a spline expressed with the B-spline
base as in \cref{eq:bsplineElement} replacing the coefficients $v_i$
with points
\begin{equation}\label{eq:bsplineCurve}
  \mathbf{S}(t)=\sum_{i=0}^n\mathbf{v_i}\cdot N_{i,k}(t).
\end{equation}
The representation of \cref{eq:bsplineCurve} is more convenient
respect to the one of 
\cref{eq:classicSplineCurve} because the curve $\mathbf{S}(t)$ roughly
follow the shape given by the points $\mathbf{v_i}$. Those points are
called \emph{control vertices} and the polygon defined by them is
called \emph{control polygon} and they can be used to control the
shape of the curve.

\section{B-splines properties}\label{sec:bsplineProp}

\section{Lagrangian relaxation}\label{sec:lagrangianRelaxation}
A general constrained discrete optimization problem can be expressed in
the form:
\begin{equation}\label[problem]{eq:opt}
\begin{aligned}
& \underset{x}{\text{minimize}}
& & f(x) \\
& \text{subject to}
& & g(x)=0.
\end{aligned}
\end{equation}
Where $x$ is the state of the system in a discrete space $X$, $f(x)$
is the function to
minimize, and $g(x)=0$ is the constraint. the functions can also be
in a multidimensional discrete space, in that case the $x$ is a vector
$\mathbf{x}=(x_1,\dots,x_n)$ of variables.

For solving this class
of problem is necessary a \emph{Lagrange relaxation} method, that
augment the variable space $X$ by a \emph{Lagrange multiplier} space
$\Lambda$ of dimension equal to the number of constraints - one in the
\cref{eq:opt}.

The \emph{generalized discrete Lagrangian
  function} corresponding to the \cref{eq:opt} is:
\begin{equation}\label{eq:lagrangianFun}
  L_d(x,\lambda)=f(x)+\lambda H(g(x)).
\end{equation}
Where $\lambda$ is a variable in $\Lambda$, and if the dimension of
$\Lambda$ is more than one $\lambda$ must be transposed in
~\cref{eq:lagrangianFun}; $H(x)$ is a non negative function
with the property that $H(0)=0$, the purpose is to transform $g(x)$ in
a non negative function - if $g(x)$ isn't already not negative - for
instance can be $H(g(x))=|g(x)|$ or $H(g(x))=g^2(x)$.

Under the previous assumptions the set of \emph{local minima}
in \cref{eq:opt} - that respect the constraints -  coincide
with the set of \emph{discrete saddle point}
in the augmented space. A point $(x^*,\lambda^*)$ is a discrete saddle
point if:
\begin{equation*}
  L_d(x^*,\lambda)\leq L_d(x^*,\lambda^*)\leq L_d(x,\lambda^*)
\end{equation*}
for all $x\in\mathcal{N}(x^*)$ and for all $\lambda\in\Lambda$, where
$\mathcal{N}(x^*)$ is the set of all neighbours of $x^*$.

For resolving the optimization \cref{eq:opt} is necessary to
calculate all the discrete saddle points $(x^*,\lambda^*)$ using some
optimization method (i.e. simulated annealing) on the surface
represented by
\cref{eq:lagrangianFun}, and then choose
the one that minimize $f(x^*)$. $x^*$ is then the desired minimum.

\section{Simulated annealing}

\section{Intersections in space}\label{sec:intersections}

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../dissertation"
%%% End:
